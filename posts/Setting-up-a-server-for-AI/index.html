<!DOCTYPE html><html lang="en" data-mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Setting up a GPU Server for AI virtual machines with Proxmox" /><meta property="og:locale" content="en" /><meta name="description" content="What is Proxmox and the advantage of Virtual Machines" /><meta property="og:description" content="What is Proxmox and the advantage of Virtual Machines" /><link rel="canonical" href="https://docs.renderex.ae/posts/Setting-up-a-server-for-AI/" /><meta property="og:url" content="https://docs.renderex.ae/posts/Setting-up-a-server-for-AI/" /><meta property="og:site_name" content="RendeRex Computers" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-05-30T00:00:00+04:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Setting up a GPU Server for AI virtual machines with Proxmox" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-05-31T03:24:41+04:00","datePublished":"2022-05-30T00:00:00+04:00","description":"What is Proxmox and the advantage of Virtual Machines","headline":"Setting up a GPU Server for AI virtual machines with Proxmox","mainEntityOfPage":{"@type":"WebPage","@id":"https://docs.renderex.ae/posts/Setting-up-a-server-for-AI/"},"url":"https://docs.renderex.ae/posts/Setting-up-a-server-for-AI/"}</script><title>Setting up a GPU Server for AI virtual machines with Proxmox | RendeRex Computers</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="RendeRex Computers"><meta name="application-name" content="RendeRex Computers"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" https://renderex.ae/assets/img/images/logo-square.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">RendeRex Computers</a></div><div class="site-subtitle font-italic">Documentation & News</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://www.linkedin.com/company/69259567/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://www.instagram.com/renderex.ae/" aria-label="instagram" target="_blank" rel="noopener"> <i class="fab fa-instagram"></i> </a> <a href="https://www.youtube.com/channel/UC3W69I_MOgw734_eXhRn57Q" aria-label="youtube" target="_blank" rel="noopener"> <i class="fab fa-youtube"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['info','renderex.ae'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Setting up a GPU Server for AI virtual machines with Proxmox</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Setting up a GPU Server for AI virtual machines with Proxmox</h1><div class="post-meta text-muted"><div> By <em> <a href="https://renderex.ae">RendeRex Computers LLC</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1653854400" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-05-30 </em> </span> <span> Updated <em class="timeago" data-ts="1653953081" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-05-31 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="877 words"> <em>4 min</em> read</span></div></div></div><div class="post-content"><h1 id="what-is-proxmox-and-the-advantage-of-virtual-machines">What is Proxmox and the advantage of Virtual Machines</h1><p>Proxmox is a debian-based, open-source virtualization environment which allows you to create virtual machines using QEMU/KVM. It has a user-friendly GUI interface and interacting with it through terminal is a breeze as the backend is just the very familiar Debian.</p><p>If you have a small team working on a single GPU server, (like the <a href="https://renderex.ae/servers/ml-server">RendeRex 8x GPU Server, the RAPTOR-8</a>), it makes sense to be able to split the GPU’s into several VM’s, allowing each team to seamlessly take advantage of however many GPU’s they’d like, and move them between VM’s without much effort.</p><p>Here, we’ll go over the very basics to get started.</p><h2 id="pre-requisites"><span class="mr-2">Pre-requisites</span><a href="#pre-requisites" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>The first thing you’ll want to do is make sure that virtualization is enabled on your hardware. This is a setting which can be found in the BIOS. For Intel, you’ll want to enable VT-d. For AMD, look for IOMMU. Most modern CPU’s support virtualization and its simply a matter of enabling it. If you bought a <a href="https://renderex.ae/servers/ml-server">pre-configured server from RendeRex</a>, this feature is already enabled for you.</p><p>We’ll be taking advantage of <strong>PCIe pass-through</strong>, allowing us to completely pass-through a PCIe device (in this case, a GPU) from the host (Proxmox), to the guest (an Ubuntu virtual machine).</p><p>This will allow us to essentially transform our GPU-server into fully functional, dynamic, independent workstations which can be used by members of the AI team.</p><h1 id="installing-proxmox">Installing Proxmox</h1><p>The first thing you’ll want to do is grab the latest version of Proxmox from <a href="https://www.proxmox.com/en/downloads">here</a>.</p><p>Once its installed, you can access the Web GUI at: https://[proxmox-server-ip]:8006</p><h1 id="configuring-proxmox--setting-up-iommu">Configuring Proxmox &amp; setting up IOMMU</h1><h2 id="1-grub"><span class="mr-2">1. Grub</span><a href="#1-grub" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Go ahead and SSH into your server, let’s start by making some changes to grub:</p><p><em>(assuming you’re logged in as root:)</em></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nano /etc/default/grub
</pre></table></code></div></div><p><strong>Replace this line</strong></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">GRUB_CMDLINE_LINUX_DEFAULT</span><span class="o">=</span><span class="s2">"quiet"</span>
</pre></table></code></div></div><p>with:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">GRUB_CMDLINE_LINUX_DEFAULT</span><span class="o">=</span><span class="s2">"quiet intel_iommu=on"</span>
</pre></table></code></div></div><p><strong><em>or</em></strong>, for AMD CPU’s</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">GRUB_CMDLINE_LINUX_DEFAULT</span><span class="o">=</span><span class="s2">"quiet amd_iommu=on"</span>
</pre></table></code></div></div><p>Next, update grub to apply the changes using:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>update-grub
</pre></table></code></div></div><h2 id="2-vfio-modules"><span class="mr-2">2. VFIO modules</span><a href="#2-vfio-modules" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>To load the VFIO modules needed for PCIe passthrough:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nano /etc/modules
</pre></table></code></div></div><p>and add:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>vfio
vfio_iommu_type1
vfio_pci
vfio_virqfd
</pre></table></code></div></div><p>Save and exit out of nano. Next, you’ll need to run the two following commands:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nb">echo</span> <span class="s2">"options vfio_iommu_type1 allow_unsafe_interrupts=1"</span> <span class="o">&gt;</span> /etc/modprobe.d/iommu_unsafe_interrupts.conf

<span class="nb">echo</span> <span class="s2">"options kvm ignore_msrs=1"</span> <span class="o">&gt;</span> /etc/modprobe.d/kvm.conf
</pre></table></code></div></div><h2 id="3-block-host-proxmox-from-loading-drivers"><span class="mr-2">3. Block host (Proxmox) from loading drivers</span><a href="#3-block-host-proxmox-from-loading-drivers" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>We’ll need to make sure that the host (in this case Proxmox) cannot load the GPU drivers. We can achieve this easily through:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nano /etc/modprobe.d/pve-blacklist.conf
</pre></table></code></div></div><p>and insert:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>blacklist nvidiafb
blacklist nvidia
blacklist radeon
blacklist nouveau
</pre></table></code></div></div><p>Save and exit nano, then <strong>reboot</strong>.</p><h2 id="3-optional-check-if-iommu-groupings-are-correct"><span class="mr-2">3. Optional (check if IOMMU groupings are correct)</span><a href="#3-optional-check-if-iommu-groupings-are-correct" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>You can check if the IOMMU groupings are correct by running the following script:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c">#!/bin/bash</span>
<span class="k">for </span>d <span class="k">in</span> /sys/kernel/iommu_groups/<span class="k">*</span>/devices/<span class="k">*</span><span class="p">;</span> <span class="k">do
  </span><span class="nv">n</span><span class="o">=</span><span class="k">${</span><span class="nv">d</span><span class="p">#*/iommu_groups/*</span><span class="k">}</span><span class="p">;</span> <span class="nv">n</span><span class="o">=</span><span class="k">${</span><span class="nv">n</span><span class="p">%%/*</span><span class="k">}</span>
  <span class="nb">printf</span> <span class="s1">'IOMMU Group %s '</span> <span class="s2">"</span><span class="nv">$n</span><span class="s2">"</span>
  lspci <span class="nt">-nns</span> <span class="s2">"</span><span class="k">${</span><span class="nv">d</span><span class="p">##*/</span><span class="k">}</span><span class="s2">"</span>
<span class="k">done</span>
</pre></table></code></div></div><p>If done correctly, the output should look something like this:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>...
IOMMU Group 51:
        1d:00.0 VGA compatible controller <span class="o">[</span>0300]: NVIDIA Corporation GA102 <span class="o">[</span>GeForce RTX 3090] <span class="o">[</span>10de:2204] <span class="o">(</span>rev a1<span class="o">)</span>
        1d:00.1 Audio device <span class="o">[</span>0403]: NVIDIA Corporation GA102 High Definition Audio Controller <span class="o">[</span>10de:1aef] <span class="o">(</span>rev a1<span class="o">)</span>
IOMMU Group 52:
        1e:00.0 VGA compatible controller <span class="o">[</span>0300]: NVIDIA Corporation GA102 <span class="o">[</span>GeForce RTX 3090] <span class="o">[</span>10de:2204] <span class="o">(</span>rev a1<span class="o">)</span>
        1e:00.1 Audio device <span class="o">[</span>0403]: NVIDIA Corporation GA102 High Definition Audio Controller <span class="o">[</span>10de:1aef] <span class="o">(</span>rev a1<span class="o">)</span>
IOMMU Group 53:
        1f:00.0 VGA compatible controller <span class="o">[</span>0300]: NVIDIA Corporation GA102 <span class="o">[</span>GeForce RTX 3090] <span class="o">[</span>10de:2204] <span class="o">(</span>rev a1<span class="o">)</span>
        1f:00.1 Audio device <span class="o">[</span>0403]: NVIDIA Corporation GA102 High Definition Audio Controller <span class="o">[</span>10de:1aef] <span class="o">(</span>rev a1<span class="o">)</span>
...
</pre></table></code></div></div><p>If you can see that each GPU has its <em>own</em> IOMMU grouping, then everything went right.</p><h2 id="4-setting-up-the-vm"><span class="mr-2">4. Setting up the VM</span><a href="#4-setting-up-the-vm" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Once the server has rebooted, access the web GUI (port <strong>8006</strong>).</p><p>We won’t go over how to set-up an Ubuntu VM here, but you can check out <a href="https://docs.renderex.ae/Setting-up-a-cloud-image-VM/">our guide on how to set up a ‘cloud image’ version of Ubuntu.</a></p><h3 id="attaching-the-gpu"><span class="mr-2">Attaching the GPU:</span><a href="#attaching-the-gpu" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Once you have your Ubuntu VM set-up, let’s go ahead and attach the GPU. Under ‘PCIe devices’, scroll down until you find the IOMMU grouping/vendor ID of the GPU you’d like to attach and select it.</p><h3 id="cpu"><span class="mr-2">CPU:</span><a href="#cpu" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Make sure that you set the CPU to ‘host’ in order to enable the AVX-512 instruction-set (required for TensorFlow).</p><h3 id="optional"><span class="mr-2">Optional</span><a href="#optional" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>If you’d like to ‘pin’ CPU cores, i.e., reserve specific cores for a virtual machine for increased performance of that CPU, this can be achieved with:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>taskset <span class="nt">--cpu-list</span> <span class="nt">--all-tasks</span> <span class="nt">--pid</span> <span class="o">[</span>cores] <span class="si">$(</span>&lt; /run/qemu-server/[pid-of-VM.pid]<span class="si">)</span>
</pre></table></code></div></div><p>For example, pinning the first 16 cores of the CPU to a VM with <strong>ID 101</strong> would look like this:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>taskset <span class="nt">--cpu-list</span> <span class="nt">--all-tasks</span> <span class="nt">--pid</span> 0-15 <span class="si">$(</span>&lt; /run/qemu-server/101.pid<span class="si">)</span>
</pre></table></code></div></div><p><em>Note that CPU core ID’s begin from 0 instead of 1.</em></p><h3 id="networking"><span class="mr-2">Networking:</span><a href="#networking" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>In order to take full advantage of networking capabilities, make sure that <strong>VirtIO</strong> is selected for the network device.</p><h3 id="hardware-summary"><span class="mr-2">Hardware Summary:</span><a href="#hardware-summary" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Your hardware should look something like this: <img data-src="https://renderex.ae/assets/img/images/docs/proxmox.png" alt="RendeRex Proxmox Setup" data-proofer-ignore></p><p>That’s it! Go ahead and start your Ubuntu VM, install the NVidia drivers, and proceed to <a href="https://docs.renderex.ae/posts/Setting-up-worktation-AI/">set it up like you would a workstation.</a></p><p><img data-src="https://renderex.ae/assets/img/images/docs/proxmox2.png" alt="RendeRex Ubuntu AI VM" data-proofer-ignore></p><p>That wraps up this tutorial. Stay tuned for further optimizations of Proxmox, VM’s for AI, storage for VM’s, Cloud-init Ubuntu Templates, and more!</p><p>For <a href="https://renderex.ae/servers/ml-server">pre-built, pre-configured GPU servers for AI</a>, be sure to visit:</p><p><a href="https://renderex.ae/servers/ml-server">https://renderex.ae/servers/ml-server</a></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ai/'>AI</a>, <a href='/categories/tutorial/'>tutorial</a>, <a href='/categories/servers/'>servers</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/renderex-computers/" class="post-tag no-text-decoration" >renderex computers</a> <a href="/tags/servers/" class="post-tag no-text-decoration" >servers</a> <a href="/tags/gpu-server/" class="post-tag no-text-decoration" >gpu server</a> <a href="/tags/ai/" class="post-tag no-text-decoration" >ai</a> <a href="/tags/tutorial/" class="post-tag no-text-decoration" >tutorial</a> <a href="/tags/ai-tutorial/" class="post-tag no-text-decoration" >ai tutorial</a> <a href="/tags/virtualization/" class="post-tag no-text-decoration" >virtualization</a> <a href="/tags/virtual-machine/" class="post-tag no-text-decoration" >virtual machine</a> <a href="/tags/pcie-passthrough/" class="post-tag no-text-decoration" >pcie passthrough</a> <a href="/tags/gpu-vm/" class="post-tag no-text-decoration" >gpu vm</a> <a href="/tags/gpu-virtual-machine/" class="post-tag no-text-decoration" >gpu virtual machine</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Setting up a GPU Server for AI virtual machines with Proxmox - RendeRex Computers&amp;url=https://docs.renderex.ae/posts/Setting-up-a-server-for-AI/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Setting up a GPU Server for AI virtual machines with Proxmox - RendeRex Computers&amp;u=https://docs.renderex.ae/posts/Setting-up-a-server-for-AI/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://docs.renderex.ae/posts/Setting-up-a-server-for-AI/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/CPU-Pinning/">CPU Pinning in Proxmox</a><li><a href="/posts/Enabling-hugepages/">Enabling Hugepages in Proxmox</a><li><a href="/posts/Creating-a-new-VM/">Creating a new VM in Proxmox</a><li><a href="/posts/Adding-an-ISO/">Adding a new ISO to Proxmox</a><li><a href="/posts/Extending-LVM-pool/">Extending an LVM storage pool in Proxmox</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ai-tutorial/">ai tutorial</a> <a class="post-tag" href="/tags/ai/">ai</a> <a class="post-tag" href="/tags/renderex-computers/">renderex computers</a> <a class="post-tag" href="/tags/servers/">servers</a> <a class="post-tag" href="/tags/tutorial/">tutorial</a> <a class="post-tag" href="/tags/virtualization/">virtualization</a> <a class="post-tag" href="/tags/gpu-server/">gpu server</a> <a class="post-tag" href="/tags/gpu-virtual-machine/">gpu virtual machine</a> <a class="post-tag" href="/tags/gpu-vm/">gpu vm</a> <a class="post-tag" href="/tags/pcie-passthrough/">pcie passthrough</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/CPU-Pinning/"><div class="card-body"> <em class="timeago small" data-ts="1655150400" > 2022-06-14 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CPU Pinning in Proxmox</h3><div class="text-muted small"><p> What is CPU pinning? Generally in virtualization, the host will spread the workload of a VM accross all of the available host cores. However, with CPU pinning, you can ‘pin’ the tasks of a VM to s...</p></div></div></a></div><div class="card"> <a href="/posts/Enabling-hugepages/"><div class="card-body"> <em class="timeago small" data-ts="1655150400" > 2022-06-14 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Enabling Hugepages in Proxmox</h3><div class="text-muted small"><p> What are Hugepages? Memory is managed in blocks known as pages. On most systems, a page is 4Ki. 1Mi of memory is equal to 256 pages; 1Gi of memory is 256,000 pages, and so on. CPUs have a built...</p></div></div></a></div><div class="card"> <a href="/posts/Setting-up-worktation-AI/"><div class="card-body"> <em class="timeago small" data-ts="1653854400" > 2022-05-30 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Setting up a Workstation for AI</h3><div class="text-muted small"><p> Getting Started The first thing you’ll want to do on your new Ubuntu installation is to blacklist nouveau. Nouveau is an open-source Linux graphics driver which is loaded at boot, but this has bee...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <span class="btn btn-outline-primary disabled" prompt="Older"><p>-</p></span> <a href="/posts/Setting-up-worktation-AI/" class="btn btn-outline-primary" prompt="Newer"><p>Setting up a Workstation for AI</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://renderex.ae">RendeRex Computers LLC</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> www.renderex.ae</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ai-tutorial/">ai tutorial</a> <a class="post-tag" href="/tags/ai/">ai</a> <a class="post-tag" href="/tags/renderex-computers/">renderex computers</a> <a class="post-tag" href="/tags/servers/">servers</a> <a class="post-tag" href="/tags/tutorial/">tutorial</a> <a class="post-tag" href="/tags/virtualization/">virtualization</a> <a class="post-tag" href="/tags/gpu-server/">gpu server</a> <a class="post-tag" href="/tags/gpu-virtual-machine/">gpu virtual machine</a> <a class="post-tag" href="/tags/gpu-vm/">gpu vm</a> <a class="post-tag" href="/tags/pcie-passthrough/">pcie passthrough</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-183491307-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-183491307-1'); }); </script>
