<!DOCTYPE html><html lang="en" data-mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Enabling Hugepages in Proxmox" /><meta property="og:locale" content="en" /><meta name="description" content="What are Hugepages?" /><meta property="og:description" content="What are Hugepages?" /><link rel="canonical" href="https://docs.renderex.ae/posts/Enabling-hugepages/" /><meta property="og:url" content="https://docs.renderex.ae/posts/Enabling-hugepages/" /><meta property="og:site_name" content="RendeRex Computers" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-06-14T00:00:00+04:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Enabling Hugepages in Proxmox" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-06-14T23:47:54+04:00","datePublished":"2022-06-14T00:00:00+04:00","description":"What are Hugepages?","headline":"Enabling Hugepages in Proxmox","mainEntityOfPage":{"@type":"WebPage","@id":"https://docs.renderex.ae/posts/Enabling-hugepages/"},"url":"https://docs.renderex.ae/posts/Enabling-hugepages/"}</script><title>Enabling Hugepages in Proxmox | RendeRex Computers</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="RendeRex Computers"><meta name="application-name" content="RendeRex Computers"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" https://renderex.ae/assets/img/images/logo-square.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">RendeRex Computers</a></div><div class="site-subtitle font-italic">Documentation & News</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://www.linkedin.com/company/69259567/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://www.instagram.com/renderex.ae/" aria-label="instagram" target="_blank" rel="noopener"> <i class="fab fa-instagram"></i> </a> <a href="https://www.youtube.com/channel/UC3W69I_MOgw734_eXhRn57Q" aria-label="youtube" target="_blank" rel="noopener"> <i class="fab fa-youtube"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['info','renderex.ae'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Enabling Hugepages in Proxmox</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Enabling Hugepages in Proxmox</h1><div class="post-meta text-muted"><div> By <em> <a href="https://renderex.ae">RendeRex Computers LLC</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1655150400" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-06-14 </em> </span> <span> Updated <em class="timeago" data-ts="1655236074" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-06-14 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="327 words"> <em>1 min</em> read</span></div></div></div><div class="post-content"><h2 id="what-are-hugepages"><span class="mr-2">What are Hugepages?</span><a href="#what-are-hugepages" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><blockquote><p>Memory is managed in blocks known as pages. On most systems, a page is 4Ki. 1Mi of memory is equal to 256 pages; 1Gi of memory is 256,000 pages, and so on. CPUs have a built-in memory management unit that manages a list of these pages in hardware. The Translation Lookaside Buffer (TLB) is a small hardware cache of virtual-to-physical page mappings. If the virtual address passed in a hardware instruction can be found in the TLB, the mapping can be determined quickly. If not, a TLB miss occurs, and the system falls back to slower, software-based address translation, resulting in performance issues. Since the size of the TLB is fixed, the only way to reduce the chance of a TLB miss is to increase the page size.</p></blockquote><blockquote><p>A huge page is a memory page that is larger than 4Ki. On x86_64 architectures, there are two common huge page sizes: 2Mi and 1Gi. Sizes vary on other architectures. To use huge pages, code must be written so that applications are aware of them. Transparent Huge Pages (THP) attempt to automate the management of huge pages without application knowledge, but they have limitations. In particular, they are limited to 2Mi page sizes. THP can lead to performance degradation on nodes with high memory utilization or fragmentation due to defragmenting efforts of THP, which can lock memory pages. For this reason, some applications may be designed to (or recommend) usage of pre-allocated huge pages instead of THP.</p></blockquote><h2 id="why-and-when-to-use-hugepages"><span class="mr-2">Why and when to use Hugepages</span><a href="#why-and-when-to-use-hugepages" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Anytime you want to create a VM with more than 64GB of RAM, you’ll want to use Hugepages.</p><h2 id="enable-hugepages"><span class="mr-2">Enable Hugepages</span><a href="#enable-hugepages" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>To enable Hugepages in Proxmox, in the “hardware tab”, under “CPU”, you want to enable the hugepages flag, which is titled <code class="language-plaintext highlighter-rouge">pdpe1gb</code>.</p><p><img data-src="https://www.renderex.ae/docs/hugepages/1.png" alt="Proxmox hugepages" data-proofer-ignore></p><p>Next, SSH into Proxmox itself and enable hugepages in GRUB:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">GRUB_CMDLINE_LINUX_DEFAULT</span><span class="o">=</span><span class="s2">"quiet intel_iommu=on hugepagesz=1G default_hugepagesz=2M"</span>
</pre></table></code></div></div><p>That’s it, you’re done! For <a href="https://renderex.ae/servers/ml-server">pre-built, pre-configured GPU servers for AI</a>, be sure to visit:</p><p><a href="https://www.renderex.ae">www.renderex.ae</a></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ai/'>AI</a>, <a href='/categories/tutorial/'>tutorial</a>, <a href='/categories/servers/'>servers</a>, <a href='/categories/proxmox/'>proxmox</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/renderex-computers/" class="post-tag no-text-decoration" >renderex computers</a> <a href="/tags/servers/" class="post-tag no-text-decoration" >servers</a> <a href="/tags/workstations/" class="post-tag no-text-decoration" >workstations</a> <a href="/tags/proxmox/" class="post-tag no-text-decoration" >proxmox</a> <a href="/tags/virtualization/" class="post-tag no-text-decoration" >virtualization</a> <a href="/tags/ai/" class="post-tag no-text-decoration" >ai</a> <a href="/tags/tutorial/" class="post-tag no-text-decoration" >tutorial</a> <a href="/tags/ai-tutorial/" class="post-tag no-text-decoration" >ai tutorial</a> <a href="/tags/linux/" class="post-tag no-text-decoration" >linux</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Enabling Hugepages in Proxmox - RendeRex Computers&amp;url=https://docs.renderex.ae/posts/Enabling-hugepages/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Enabling Hugepages in Proxmox - RendeRex Computers&amp;u=https://docs.renderex.ae/posts/Enabling-hugepages/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://docs.renderex.ae/posts/Enabling-hugepages/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/CPU-Pinning/">CPU Pinning in Proxmox</a><li><a href="/posts/Enabling-hugepages/">Enabling Hugepages in Proxmox</a><li><a href="/posts/Creating-a-new-VM/">Creating a new VM in Proxmox</a><li><a href="/posts/Adding-an-ISO/">Adding a new ISO to Proxmox</a><li><a href="/posts/Extending-LVM-pool/">Extending an LVM storage pool in Proxmox</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ai-tutorial/">ai tutorial</a> <a class="post-tag" href="/tags/ai/">ai</a> <a class="post-tag" href="/tags/renderex-computers/">renderex computers</a> <a class="post-tag" href="/tags/servers/">servers</a> <a class="post-tag" href="/tags/tutorial/">tutorial</a> <a class="post-tag" href="/tags/virtualization/">virtualization</a> <a class="post-tag" href="/tags/gpu-server/">gpu server</a> <a class="post-tag" href="/tags/gpu-virtual-machine/">gpu virtual machine</a> <a class="post-tag" href="/tags/gpu-vm/">gpu vm</a> <a class="post-tag" href="/tags/pcie-passthrough/">pcie passthrough</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Extending-LVM-pool/"><div class="card-body"> <em class="timeago small" data-ts="1653940800" > 2022-05-31 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Extending an LVM storage pool in Proxmox</h3><div class="text-muted small"><p> Format the drive First, list the available disks: fdisk -l Format the disk you want to add, creating a partition, in this case we will create sdf1 on the disk sdf: cfdisk /dev/sdf Create a phys...</p></div></div></a></div><div class="card"> <a href="/posts/Setting-up-a-cloud-image-VM/"><div class="card-body"> <em class="timeago small" data-ts="1653940800" > 2022-05-31 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Setting up a Cloud Image template and Cloud Init</h3><div class="text-muted small"><p> What is a ‘Cloud Image’? Cloud Images are lightweight, faster, certified cloud-ready versions of operating systems. They have Cloud Init pre-installed, meaning they can be configured using ‘Cloud ...</p></div></div></a></div><div class="card"> <a href="/posts/Setting-up-worktation-AI/"><div class="card-body"> <em class="timeago small" data-ts="1653854400" > 2022-05-30 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Setting up a Workstation for AI</h3><div class="text-muted small"><p> Getting Started The first thing you’ll want to do on your new Ubuntu installation is to blacklist nouveau. Nouveau is an open-source Linux graphics driver which is loaded at boot, but this has bee...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Creating-a-new-VM/" class="btn btn-outline-primary" prompt="Older"><p>Creating a new VM in Proxmox</p></a> <a href="/posts/Introduction-to-RendeRex/" class="btn btn-outline-primary" prompt="Newer"><p>Introduction to RendeRex services in compute and GPU clusters</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://renderex.ae">RendeRex Computers LLC</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> www.renderex.ae</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ai-tutorial/">ai tutorial</a> <a class="post-tag" href="/tags/ai/">ai</a> <a class="post-tag" href="/tags/renderex-computers/">renderex computers</a> <a class="post-tag" href="/tags/servers/">servers</a> <a class="post-tag" href="/tags/tutorial/">tutorial</a> <a class="post-tag" href="/tags/virtualization/">virtualization</a> <a class="post-tag" href="/tags/gpu-server/">gpu server</a> <a class="post-tag" href="/tags/gpu-virtual-machine/">gpu virtual machine</a> <a class="post-tag" href="/tags/gpu-vm/">gpu vm</a> <a class="post-tag" href="/tags/pcie-passthrough/">pcie passthrough</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-183491307-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-183491307-1'); }); </script>
